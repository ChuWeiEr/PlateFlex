
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>Module estimate &#8212; plateflex 0.0.1 documentation</title>
    <link rel="stylesheet" href="_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/style.css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/language_data.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Module plotting" href="plotting.html" />
    <link rel="prev" title="Classes" href="classes.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="plotting.html" title="Module plotting"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="classes.html" title="Classes"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">plateflex 0.0.1 documentation</a> &#187;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h4>Previous topic</h4>
  <p class="topless"><a href="classes.html"
                        title="previous chapter">Classes</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="plotting.html"
                        title="next chapter">Module plotting</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/estimate.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="module-plateflex.estimate">
<span id="module-estimate"></span><h1>Module estimate<a class="headerlink" href="#module-plateflex.estimate" title="Permalink to this headline">¶</a></h1>
<p>This <code class="xref py py-mod docutils literal notranslate"><span class="pre">plateflex</span></code> module contains the following functions:</p>
<ul class="simple">
<li><p><a class="reference internal" href="#plateflex.estimate.bayes_estimate_cell" title="plateflex.estimate.bayes_estimate_cell"><code class="xref py py-func docutils literal notranslate"><span class="pre">bayes_estimate_cell()</span></code></a>: Set up <code class="xref py py-mod docutils literal notranslate"><span class="pre">pymc</span></code> model and estimate the parameters
of the elastic plate model using a probabilistic Bayesian inference method.</p></li>
<li><p><a class="reference internal" href="#plateflex.estimate.get_bayes_estimates" title="plateflex.estimate.get_bayes_estimates"><code class="xref py py-func docutils literal notranslate"><span class="pre">get_bayes_estimates()</span></code></a>: Explore the output of sampling the <code class="xref py py-mod docutils literal notranslate"><span class="pre">pymc</span></code> model</p></li>
<li><p><a class="reference internal" href="#plateflex.estimate.L2_estimate_cell" title="plateflex.estimate.L2_estimate_cell"><code class="xref py py-func docutils literal notranslate"><span class="pre">L2_estimate_cell()</span></code></a>: Set up non-linear curve fitting to estimate the parameters
of the elastic plate model using non-linear least-squares from the function <code class="xref py py-func docutils literal notranslate"><span class="pre">scipy.optimize.curve_fit()</span></code>.</p></li>
<li><p><a class="reference internal" href="#plateflex.estimate.get_L2_estimates" title="plateflex.estimate.get_L2_estimates"><code class="xref py py-func docutils literal notranslate"><span class="pre">get_L2_estimates()</span></code></a>: Explore the output the non-linear inversion</p></li>
<li><p><a class="reference internal" href="#plateflex.estimate.real_xspec_functions" title="plateflex.estimate.real_xspec_functions"><code class="xref py py-func docutils literal notranslate"><span class="pre">real_xspec_functions()</span></code></a>: Calculate the analytical admittance and coherence functions.</p></li>
</ul>
<p>Internal functions are also available to define predicted admittance and coherence data
with <code class="docutils literal notranslate"><span class="pre">theano</span></code> decorators to be incorporated as pymc variables. These functions are
used within <code class="xref py py-class docutils literal notranslate"><span class="pre">Project</span></code> methods as with <code class="xref py py-mod docutils literal notranslate"><span class="pre">plotting</span></code>
functions.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>If you plan to estimate model parameters over entire grids, the non-linear least-squares method
is orders of magnitude faster than the probabilistic method and should be preferred. The probabilistic
method, on the other hand, gives useful estimation statistics from sampling the posterior distribution
and can provide better insight on the trade-off between parameters. Estimates from the two methods are
otherwise asymptotically identical (i.e., given infinite sampling of the posterior)</p>
</div>
<dl class="function">
<dt id="plateflex.estimate.bayes_estimate_cell">
<code class="sig-prename descclassname">plateflex.estimate.</code><code class="sig-name descname">bayes_estimate_cell</code><span class="sig-paren">(</span><em class="sig-param">k</em>, <em class="sig-param">adm</em>, <em class="sig-param">eadm</em>, <em class="sig-param">coh</em>, <em class="sig-param">ecoh</em>, <em class="sig-param">alph=False</em>, <em class="sig-param">atype='joint'</em><span class="sig-paren">)</span><a class="headerlink" href="#plateflex.estimate.bayes_estimate_cell" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to estimate the parameters of the flexural model at a single cell location
of the input grids.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>k</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>) – 1D array of wavenumbers</p></li>
<li><p><strong>adm</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>) – 1D array of wavelet admittance</p></li>
<li><p><strong>eadm</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>) – 1D array of error on wavelet admittance</p></li>
<li><p><strong>coh</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>) – 1D array of wavelet coherence</p></li>
<li><p><strong>ecoh</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>) – 1D array of error on wavelet coherence</p></li>
<li><p><strong>alph</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether or not to estimate parameter <code class="docutils literal notranslate"><span class="pre">alpha</span></code></p></li>
<li><p><strong>atype</strong> (<em>str</em><em>, </em><em>optional</em>) – Whether to use the admittance (<cite>‘admit’</cite>), coherence (<cite>‘coh’</cite>) or both (<cite>‘joint’</cite>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><dl>
<dt>(tuple): Tuple containing:</dt><dd><ul>
<li><dl>
<dt><code class="docutils literal notranslate"><span class="pre">trace</span></code><span class="classifier"><code class="xref py py-class docutils literal notranslate"><span class="pre">MultiTrace</span></code></span></dt><dd><p>Posterior samples from the MCMC chains</p>
</dd>
</dl>
</li>
<li><dl>
<dt><code class="docutils literal notranslate"><span class="pre">summary</span></code><span class="classifier"><code class="xref py py-class docutils literal notranslate"><span class="pre">DataFrame</span></code></span></dt><dd><p>Summary statistics from Posterior distributions</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">map_estimate</span></code><span class="classifier">dict</span></dt><dd><p>Container for Maximum a Posteriori (MAP) estimates</p>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="plateflex.estimate.get_bayes_estimates">
<code class="sig-prename descclassname">plateflex.estimate.</code><code class="sig-name descname">get_bayes_estimates</code><span class="sig-paren">(</span><em class="sig-param">summary</em>, <em class="sig-param">map_estimate</em><span class="sig-paren">)</span><a class="headerlink" href="#plateflex.estimate.get_bayes_estimates" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns digestible estimates from the Posterior distributions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>summary</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">DataFrame</span></code>) – Summary statistics from Posterior distributions</p></li>
<li><p><strong>map_estimate</strong> (<em>dict</em>) – Container for Maximum a Posteriori (MAP) estimates</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><dl class="simple">
<dt>(tuple): tuple containing:</dt><dd><ul class="simple">
<li><p>mean_te (float) : Mean value of elastic thickness <code class="docutils literal notranslate"><span class="pre">Te</span></code> from posterior (km)</p></li>
<li><p>std_te (float)  : Standard deviation of elastic thickness <code class="docutils literal notranslate"><span class="pre">Te</span></code> from posterior (km)</p></li>
<li><p>C2_5_te (float) : Lower limit of 95% confidence interval on <code class="docutils literal notranslate"><span class="pre">Te</span></code> (km)</p></li>
<li><p>C97_5_te (float) : Upper limit of 95% confidence interval on <code class="docutils literal notranslate"><span class="pre">Te</span></code> (km)</p></li>
<li><p>MAP_te (float) : Maximum a Posteriori <code class="docutils literal notranslate"><span class="pre">Te</span></code> (km)</p></li>
<li><p>mean_F (float)  : Mean value of load ratio <code class="docutils literal notranslate"><span class="pre">F</span></code> from posterior</p></li>
<li><p>std_F (float)   : Standard deviation of load ratio <code class="docutils literal notranslate"><span class="pre">F</span></code> from posterior</p></li>
<li><p>C2_5_F (float) : Lower limit of 95% confidence interval on <code class="docutils literal notranslate"><span class="pre">F</span></code></p></li>
<li><p>C97_5_F (float) : Upper limit of 95% confidence interval on <code class="docutils literal notranslate"><span class="pre">F</span></code></p></li>
<li><p>MAP_F (float)  : Maximum a Posteriori load ratio <code class="docutils literal notranslate"><span class="pre">F</span></code></p></li>
<li><p>mean_a (float, optional)  : Mean value of initial phase difference <code class="docutils literal notranslate"><span class="pre">alpha</span></code> from posterior</p></li>
<li><p>std_a (float, optional)   : Standard deviation of initial phase difference <cite>alpha`</cite> from posterior</p></li>
<li><p>C2_5_a (float, optional) : Lower limit of 95% confidence interval on <code class="docutils literal notranslate"><span class="pre">alpha</span></code></p></li>
<li><p>C97_5_a (float, optional) : Upper limit of 95% confidence interval on <code class="docutils literal notranslate"><span class="pre">alpha</span></code></p></li>
<li><p>MAP_a (float, optional)  : Maximum a Posteriori initial phase difference <code class="docutils literal notranslate"><span class="pre">alpha</span></code></p></li>
</ul>
</dd>
</dl>
</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="plateflex.estimate.L2_estimate_cell">
<code class="sig-prename descclassname">plateflex.estimate.</code><code class="sig-name descname">L2_estimate_cell</code><span class="sig-paren">(</span><em class="sig-param">k</em>, <em class="sig-param">adm</em>, <em class="sig-param">eadm</em>, <em class="sig-param">coh</em>, <em class="sig-param">ecoh</em>, <em class="sig-param">alph=False</em>, <em class="sig-param">atype='joint'</em><span class="sig-paren">)</span><a class="headerlink" href="#plateflex.estimate.L2_estimate_cell" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to estimate the parameters of the flexural model at a single cell location
of the input grids.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>k</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>) – 1D array of wavenumbers</p></li>
<li><p><strong>adm</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>) – 1D array of wavelet admittance</p></li>
<li><p><strong>eadm</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>) – 1D array of error on wavelet admittance</p></li>
<li><p><strong>coh</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>) – 1D array of wavelet coherence</p></li>
<li><p><strong>ecoh</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>) – 1D array of error on wavelet coherence</p></li>
<li><p><strong>alph</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether or not to estimate parameter <code class="docutils literal notranslate"><span class="pre">alpha</span></code></p></li>
<li><p><strong>atype</strong> (<em>str</em><em>, </em><em>optional</em>) – Whether to use the admittance (<cite>‘admit’</cite>), coherence (<cite>‘coh’</cite>) or both (<cite>‘joint’</cite>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><dl>
<dt>(tuple): Tuple containing:</dt><dd><ul>
<li><dl>
<dt><code class="docutils literal notranslate"><span class="pre">summary</span></code><span class="classifier"><code class="xref py py-class docutils literal notranslate"><span class="pre">DataFrame</span></code></span></dt><dd><p>Summary statistics from L2 estimation</p>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="plateflex.estimate.get_L2_estimates">
<code class="sig-prename descclassname">plateflex.estimate.</code><code class="sig-name descname">get_L2_estimates</code><span class="sig-paren">(</span><em class="sig-param">summary</em><span class="sig-paren">)</span><a class="headerlink" href="#plateflex.estimate.get_L2_estimates" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns digestible estimates from the L2 estimates.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>summary</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">DataFrame</span></code>) – Summary statistics from Posterior distributions</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><dl class="simple">
<dt>(tuple): tuple containing:</dt><dd><ul class="simple">
<li><p>mean_te (float) : Mean value of elastic thickness from posterior (km)</p></li>
<li><p>std_te (float)  : Standard deviation of elastic thickness from posterior (km)</p></li>
<li><p>mean_F (float)  : Mean value of load ratio from posterior</p></li>
<li><p>std_F (float)   : Standard deviation of load ratio from posterior</p></li>
<li><p>mean_a (float, optional)  : Mean value of phase difference between initial loads from posterior</p></li>
<li><p>std_a (float, optional)   : Standard deviation of phase difference between initial loads from posterior</p></li>
<li><p>rchi2 (float)   : Reduced chi-squared value</p></li>
</ul>
</dd>
</dl>
</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="plateflex.estimate.real_xspec_functions">
<code class="sig-prename descclassname">plateflex.estimate.</code><code class="sig-name descname">real_xspec_functions</code><span class="sig-paren">(</span><em class="sig-param">k</em>, <em class="sig-param">Te</em>, <em class="sig-param">F</em>, <em class="sig-param">alpha=1.5707963267948966</em><span class="sig-paren">)</span><a class="headerlink" href="#plateflex.estimate.real_xspec_functions" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate analytical expressions for the real component of admittance
and coherence functions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>k</strong> (<em>np.ndarray</em>) – Wavenumbers (rad/m)</p></li>
<li><p><strong>Te</strong> (<em>float</em>) – Effective elastic thickness (km)</p></li>
<li><p><strong>F</strong> (<em>float</em>) – Subsurface-to-surface load ratio [0, 1[</p></li>
<li><p><strong>alpha</strong> (<em>float</em><em>, </em><em>optional</em>) – Phase difference between initial applied loads (rad)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><dl class="simple">
<dt>(tuple): tuple containing:</dt><dd><ul class="simple">
<li><p>admittance (<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>): Real admittance function (shape: <code class="docutils literal notranslate"><span class="pre">len(k)</span></code>)</p></li>
<li><p>coherence (<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>): Coherence functions (shape: <code class="docutils literal notranslate"><span class="pre">len(k)</span></code>)</p></li>
</ul>
</dd>
</dl>
</p>
</dd>
</dl>
</dd></dl>

</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="plotting.html" title="Module plotting"
             >next</a> |</li>
        <li class="right" >
          <a href="classes.html" title="Classes"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">plateflex 0.0.1 documentation</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2019, Pascal Audet.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 2.2.0.
    </div>
  </body>
</html>